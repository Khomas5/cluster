{"version":3,"file":"internal-common.js","sources":["../src/structs/resource.ts","../src/api/ResourceApi.ts","../src/common/ResourceSplitter.ts","../src/resources-crud.ts","../src/render-hooks.ts","../src/common/ResourceLabelContainer.tsx","../src/common/ResourceCell.tsx","../src/common/ResourceDayHeader.tsx","../src/common/ResourceIndex.ts","../src/common/AbstractResourceDayTableModel.ts","../src/common/ResourceDayTableModel.ts","../src/common/DayResourceTableModel.ts","../src/common/VResourceJoiner.ts","../src/common/VResourceSplitter.ts","../src/common/resource-hierarchy.ts"],"sourcesContent":["import { ConstraintInput, AllowFunc, BusinessHoursInput } from '@fullcalendar/core'\nimport {\n  EventStore, parseBusinessHours, CalendarContext, EventUi,\n  guid, identity, Identity, RawOptionsFromRefiners, parseClassNames, refineProps, createEventUi, Dictionary,\n} from '@fullcalendar/core/internal'\n\nconst PRIVATE_ID_PREFIX = '_fc:'\n\nconst RESOURCE_REFINERS = {\n  id: String,\n  parentId: String,\n  children: identity as Identity<ResourceInput[]>,\n  title: String,\n  businessHours: identity as Identity<BusinessHoursInput>,\n  extendedProps: identity as Identity<Dictionary>,\n\n  // event-ui\n  eventEditable: Boolean,\n  eventStartEditable: Boolean,\n  eventDurationEditable: Boolean,\n  eventConstraint: identity as Identity<ConstraintInput>,\n  eventOverlap: Boolean, // can NOT be a func, different from OptionsInput\n  eventAllow: identity as Identity<AllowFunc>,\n  eventClassNames: parseClassNames,\n  eventBackgroundColor: String,\n  eventBorderColor: String,\n  eventTextColor: String,\n  eventColor: String,\n}\n\ntype BuiltInResourceRefiners = typeof RESOURCE_REFINERS\n\nexport interface ResourceRefiners extends BuiltInResourceRefiners {\n  // for preventing circular definition. also, good for making ambient in the future\n}\n\nexport type ResourceInput =\n  RawOptionsFromRefiners<Required<ResourceRefiners>> & // Required hack\n  { [extendedProps: string]: any }\n\nexport interface Resource {\n  id: string\n  parentId: string\n  title: string\n  businessHours: EventStore | null // if null, will fall thru to non-resource business hours\n  ui: EventUi\n  extendedProps: { [extendedProp: string]: any }\n}\n\nexport type ResourceHash = { [resourceId: string]: Resource }\n\n/*\nneeds a full store so that it can populate children too\n*/\nexport function parseResource(raw: ResourceInput, parentId: string = '', store: ResourceHash, context: CalendarContext): Resource {\n  let { refined, extra } = refineProps(raw, RESOURCE_REFINERS)\n\n  let resource: Resource = {\n    id: refined.id || (PRIVATE_ID_PREFIX + guid()),\n    parentId: refined.parentId || parentId,\n    title: refined.title || '',\n    businessHours: refined.businessHours ? parseBusinessHours(refined.businessHours, context) : null,\n    ui: createEventUi({\n      editable: refined.eventEditable,\n      startEditable: refined.eventStartEditable,\n      durationEditable: refined.eventDurationEditable,\n      constraint: refined.eventConstraint,\n      overlap: refined.eventOverlap,\n      allow: refined.eventAllow,\n      classNames: refined.eventClassNames,\n      backgroundColor: refined.eventBackgroundColor,\n      borderColor: refined.eventBorderColor,\n      textColor: refined.eventTextColor,\n      color: refined.eventColor,\n    }, context),\n    extendedProps: {\n      ...extra,\n      ...refined.extendedProps,\n    },\n  }\n\n  // help out ResourceApi from having user modify props\n  Object.freeze(resource.ui.classNames)\n  Object.freeze(resource.extendedProps)\n\n  if (store[resource.id]) {\n    // console.warn('duplicate resource ID')\n\n  } else {\n    store[resource.id] = resource\n\n    if (refined.children) {\n      for (let childInput of refined.children) {\n        parseResource(childInput, resource.id, store, context)\n      }\n    }\n  }\n\n  return resource\n}\n\n/*\nTODO: use this in more places\n*/\nexport function getPublicId(id: string): string {\n  if (id.indexOf(PRIVATE_ID_PREFIX) === 0) {\n    return ''\n  }\n\n  return id\n}\n","import { EventApi } from '@fullcalendar/core'\nimport { EventImpl, CalendarContext, Dictionary } from '@fullcalendar/core/internal'\nimport { Resource, getPublicId, ResourceHash } from '../structs/resource.js'\n\nexport class ResourceApi {\n  constructor(\n    private _context: CalendarContext,\n    public _resource: Resource,\n  ) {\n  }\n\n  setProp(name: string, value: any) {\n    let oldResource = this._resource\n\n    this._context.dispatch({\n      type: 'SET_RESOURCE_PROP',\n      resourceId: oldResource.id,\n      propName: name,\n      propValue: value,\n    })\n\n    this.sync(oldResource)\n  }\n\n  setExtendedProp(name: string, value: any) {\n    let oldResource = this._resource\n\n    this._context.dispatch({\n      type: 'SET_RESOURCE_EXTENDED_PROP',\n      resourceId: oldResource.id,\n      propName: name,\n      propValue: value,\n    })\n\n    this.sync(oldResource)\n  }\n\n  private sync(oldResource: Resource) {\n    let context = this._context\n    let resourceId = oldResource.id\n\n    // TODO: what if dispatch didn't complete synchronously?\n    this._resource = context.getCurrentData().resourceStore[resourceId]\n\n    context.emitter.trigger('resourceChange', {\n      oldResource: new ResourceApi(context, oldResource),\n      resource: this,\n      revert() {\n        context.dispatch({\n          type: 'ADD_RESOURCE', // function as a merge. TODO: rename\n          resourceHash: {\n            [resourceId]: oldResource,\n          },\n        })\n      },\n    })\n  }\n\n  remove() {\n    let context = this._context\n    let internalResource = this._resource\n    let resourceId = internalResource.id\n\n    context.dispatch({\n      type: 'REMOVE_RESOURCE',\n      resourceId,\n    })\n\n    context.emitter.trigger('resourceRemove', {\n      resource: this,\n      revert() {\n        context.dispatch({\n          type: 'ADD_RESOURCE', // function as a merge. TODO: rename\n          resourceHash: {\n            [resourceId]: internalResource,\n          },\n        })\n      },\n    })\n  }\n\n  getParent(): ResourceApi | null {\n    let context = this._context\n    let parentId = this._resource.parentId\n\n    if (parentId) {\n      return new ResourceApi(\n        context,\n        context.getCurrentData().resourceSource[parentId],\n      )\n    }\n\n    return null\n  }\n\n  getChildren(): ResourceApi[] {\n    let thisResourceId = this._resource.id\n    let context = this._context\n    let { resourceStore } = context.getCurrentData()\n    let childApis: ResourceApi[] = []\n\n    for (let resourceId in resourceStore) {\n      if (resourceStore[resourceId].parentId === thisResourceId) {\n        childApis.push(\n          new ResourceApi(context, resourceStore[resourceId]),\n        )\n      }\n    }\n\n    return childApis\n  }\n\n  /*\n  this is really inefficient!\n  TODO: make EventApi::resourceIds a hash or keep an index in the Calendar's state\n  */\n  getEvents(): EventApi[] {\n    let thisResourceId = this._resource.id\n    let context = this._context\n    let { defs, instances } = context.getCurrentData().eventStore\n    let eventApis: EventApi[] = []\n\n    for (let instanceId in instances) {\n      let instance = instances[instanceId]\n      let def = defs[instance.defId]\n\n      if (def.resourceIds.indexOf(thisResourceId) !== -1) { // inefficient!!!\n        eventApis.push(new EventImpl(context, def, instance))\n      }\n    }\n\n    return eventApis\n  }\n\n  get id(): string { return getPublicId(this._resource.id) }\n  get title(): string { return this._resource.title }\n  get eventConstraint(): any { return this._resource.ui.constraints[0] || null } // TODO: better type\n  get eventOverlap(): boolean { return this._resource.ui.overlap }\n  get eventAllow(): any { return this._resource.ui.allows[0] || null } // TODO: better type\n  get eventBackgroundColor(): string { return this._resource.ui.backgroundColor }\n  get eventBorderColor(): string { return this._resource.ui.borderColor }\n  get eventTextColor(): string { return this._resource.ui.textColor }\n\n  // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n  get eventClassNames() { return this._resource.ui.classNames }\n  get extendedProps() { return this._resource.extendedProps }\n\n  toPlainObject(settings: { collapseExtendedProps?: boolean, collapseEventColor?: boolean } = {}) {\n    let internal = this._resource\n    let { ui } = internal\n    let publicId = this.id\n    let res: Dictionary = {}\n\n    if (publicId) {\n      res.id = publicId\n    }\n\n    if (internal.title) {\n      res.title = internal.title\n    }\n\n    if (settings.collapseEventColor && ui.backgroundColor && ui.backgroundColor === ui.borderColor) {\n      res.eventColor = ui.backgroundColor\n    } else {\n      if (ui.backgroundColor) {\n        res.eventBackgroundColor = ui.backgroundColor\n      }\n      if (ui.borderColor) {\n        res.eventBorderColor = ui.borderColor\n      }\n    }\n\n    if (ui.textColor) {\n      res.eventTextColor = ui.textColor\n    }\n\n    if (ui.classNames.length) {\n      res.eventClassNames = ui.classNames\n    }\n\n    if (Object.keys(internal.extendedProps).length) {\n      if (settings.collapseExtendedProps) {\n        Object.assign(res, internal.extendedProps)\n      } else {\n        res.extendedProps = internal.extendedProps\n      }\n    }\n\n    return res\n  }\n\n  toJSON() {\n    return this.toPlainObject()\n  }\n}\n\nexport function buildResourceApis(resourceStore: ResourceHash, context: CalendarContext) {\n  let resourceApis: ResourceApi[] = []\n\n  for (let resourceId in resourceStore) {\n    resourceApis.push(new ResourceApi(context, resourceStore[resourceId]))\n  }\n\n  return resourceApis\n}\n","import { Splitter, SplittableProps, DateSpan, EventDef } from '@fullcalendar/core/internal'\nimport { ResourceHash } from '../structs/resource.js'\n\nexport interface SplittableResourceProps extends SplittableProps {\n  resourceStore: ResourceHash\n}\n\n/*\nsplits things BASED OFF OF which resources they are associated with.\ncreates a '' entry which is when something has NO resource.\n*/\nexport class ResourceSplitter extends Splitter<SplittableResourceProps> {\n  getKeyInfo(props: SplittableResourceProps) {\n    return {\n      '': {}, // needed for non-resource\n      ...props.resourceStore, // already has `ui` and `businessHours` keys!\n    }\n  }\n\n  getKeysForDateSpan(dateSpan: DateSpan): string[] {\n    return [dateSpan.resourceId || '']\n  }\n\n  getKeysForEventDef(eventDef: EventDef): string[] {\n    let resourceIds = eventDef.resourceIds\n\n    if (!resourceIds.length) {\n      return ['']\n    }\n\n    return resourceIds\n  }\n}\n","import { CalendarData, OrderSpec, parseFieldSpecs } from '@fullcalendar/core/internal'\nimport { buildResourceApis, ResourceApi } from './api/ResourceApi.js'\nimport { ResourceHash } from './structs/resource.js'\n\nexport const DEFAULT_RESOURCE_ORDER: OrderSpec<unknown>[] = parseFieldSpecs('id,title')\n\nexport interface ResourceAddArg {\n  resource: ResourceApi\n  revert: () => void\n}\n\nexport interface ResourceChangeArg {\n  oldResource: ResourceApi\n  resource: ResourceApi\n  revert: () => void\n}\n\nexport interface ResourceRemoveArg {\n  resource: ResourceApi\n  revert: () => void\n}\n\nexport function handleResourceStore(resourceStore: ResourceHash, calendarData: CalendarData) {\n  let { emitter } = calendarData\n\n  if (emitter.hasHandlers('resourcesSet')) {\n    emitter.trigger('resourcesSet', buildResourceApis(resourceStore, calendarData))\n  }\n}\n","import { CalendarContext, MountArg } from '@fullcalendar/core/internal'\nimport { ResourceApi } from './api/ResourceApi.js'\nimport { Resource } from './structs/resource.js'\n\nexport interface ResourceLaneContentArgInput {\n  resource: Resource\n  context: CalendarContext\n}\n\nexport interface ResourceLaneContentArg {\n  resource: ResourceApi\n}\n\nexport type ResourceLaneMountArg = MountArg<ResourceLaneContentArg>\n\nexport function refineRenderProps(input: ResourceLaneContentArgInput): ResourceLaneContentArg {\n  return {\n    resource: new ResourceApi(input.context, input.resource),\n  }\n}\n","import { ViewApi } from '@fullcalendar/core'\nimport {\n  ViewContextType, ViewContext,\n  formatDayString, MountArg,\n  ContentContainer,\n  ElProps,\n  InnerContainerFunc,\n  memoizeObjArg,\n  BaseComponent,\n} from '@fullcalendar/core/internal'\nimport { createElement } from '@fullcalendar/core/preact'\nimport { Resource } from '../structs/resource.js'\nimport { ResourceApi } from '../api/ResourceApi.js'\n\nexport interface ResourceLabelContainerProps extends ElProps {\n  resource: Resource\n  date?: Date\n  children?: InnerContainerFunc<ResourceLabelContentArg>\n}\n\nexport interface ResourceLabelContentArg {\n  resource: ResourceApi\n  date?: Date\n  view: ViewApi\n}\n\nexport type ResourceLabelMountArg = MountArg<ResourceLabelContentArg>\n\n// TODO: not used for Spreadsheet. START USING. difficult because of col-specific rendering props\n\nexport class ResourceLabelContainer extends BaseComponent<ResourceLabelContainerProps> {\n  private refineRenderProps = memoizeObjArg(refineRenderProps)\n\n  render() {\n    const { props } = this\n\n    return (\n      <ViewContextType.Consumer>\n        {(context: ViewContext) => {\n          let { options } = context\n          let renderProps = this.refineRenderProps({\n            resource: props.resource,\n            date: props.date,\n            context,\n          })\n\n          return (\n            <ContentContainer\n              {...props}\n              elAttrs={{\n                ...props.elAttrs,\n                'data-resource-id': props.resource.id, // TODO: only do public-facing one?\n                'data-date': props.date ? formatDayString(props.date) : undefined,\n              }}\n              renderProps={renderProps}\n              generatorName=\"resourceLabelContent\"\n              generator={options.resourceLabelContent || renderInnerContent}\n              classNameGenerator={options.resourceLabelClassNames}\n              didMount={options.resourceLabelDidMount}\n              willUnmount={options.resourceLabelWillUnmount}\n            />\n          )\n        }}\n      </ViewContextType.Consumer>\n    )\n  }\n}\n\nfunction renderInnerContent(props: ResourceLabelContentArg) {\n  return props.resource.title || props.resource.id\n}\n\n// Render Props\n\ninterface ResourceLabelRenderPropsInput {\n  resource: Resource\n  date: Date\n  context: ViewContext\n}\n\nfunction refineRenderProps(input: ResourceLabelRenderPropsInput): ResourceLabelContentArg {\n  return {\n    resource: new ResourceApi(input.context, input.resource),\n    date: input.date ? input.context.dateEnv.toDate(input.date) : null,\n    view: input.context.viewApi,\n  }\n}\n","import { BaseComponent, DateMarker } from '@fullcalendar/core/internal'\nimport { createElement } from '@fullcalendar/core/preact'\nimport { Resource } from '../structs/resource.js'\nimport { ResourceLabelContainer } from './ResourceLabelContainer.js'\n\nexport interface ResourceCellProps {\n  resource: Resource\n  colSpan: number\n  date?: DateMarker\n  isSticky?: boolean\n}\n\nexport class ResourceCell extends BaseComponent<ResourceCellProps> {\n  render() {\n    let { props } = this\n\n    return (\n      <ResourceLabelContainer\n        elTag=\"th\"\n        elClasses={['fc-col-header-cell', 'fc-resource']}\n        elAttrs={{\n          role: 'columnheader',\n          colSpan: props.colSpan,\n        }}\n        resource={props.resource}\n        date={props.date}\n      >\n        {(InnerContent) => (\n          <div className=\"fc-scrollgrid-sync-inner\">\n            <InnerContent\n              elTag=\"span\"\n              elClasses={[\n                'fc-col-header-cell-cushion',\n                props.isSticky && 'fc-sticky',\n              ]}\n            />\n          </div>\n        )}\n      </ResourceLabelContainer>\n    )\n  }\n}\n","import {\n  TableDowCell, memoize, BaseComponent,\n  DateMarker, DateFormatter, computeFallbackHeaderFormat, TableDateCell,\n  DateRange, NowTimer, DateProfile,\n} from '@fullcalendar/core/internal'\nimport {\n  VNode, createElement, Fragment,\n} from '@fullcalendar/core/preact'\nimport { Resource } from '../structs/resource.js'\nimport { ResourceApi } from '../api/ResourceApi.js'\nimport { ResourceCell } from './ResourceCell.js'\n\nexport interface ResourceDayHeaderProps {\n  dates: DateMarker[]\n  dateProfile: DateProfile\n  datesRepDistinctDays: boolean\n  resources: Resource[] // flattened\n  renderIntro?: (rowKey: string) => VNode\n}\n\nexport class ResourceDayHeader extends BaseComponent<ResourceDayHeaderProps> { // TODO: rename to ResourceDayHeaderTrs?\n  private buildDateFormat = memoize(buildDateFormat)\n\n  render() {\n    let { props, context } = this\n    let dateFormat = this.buildDateFormat(\n      context.options.dayHeaderFormat,\n      props.datesRepDistinctDays,\n      props.dates.length,\n    )\n\n    return (\n      <NowTimer unit=\"day\">\n        {(nowDate: DateMarker, todayRange: DateRange) => {\n          if (props.dates.length === 1) {\n            return this.renderResourceRow(props.resources, props.dates[0])\n          }\n          if (context.options.datesAboveResources) {\n            return this.renderDayAndResourceRows(props.dates, dateFormat, todayRange, props.resources)\n          }\n          return this.renderResourceAndDayRows(props.resources, props.dates, dateFormat, todayRange)\n        }}\n      </NowTimer>\n    )\n  }\n\n  renderResourceRow(resources: Resource[], date: DateMarker) {\n    let resourceCells = resources.map((resource) => (\n      <ResourceCell\n        key={resource.id}\n        resource={resource}\n        colSpan={1}\n        date={date}\n      />\n    ))\n    return this.buildTr(resourceCells, 'resources')\n  }\n\n  renderDayAndResourceRows(dates: DateMarker[], dateFormat: DateFormatter, todayRange: DateRange, resources: Resource[]) {\n    let dateCells: VNode[] = []\n    let resourceCells: VNode[] = []\n\n    for (let date of dates) {\n      dateCells.push(\n        this.renderDateCell(date, dateFormat, todayRange, resources.length, null, true),\n      )\n\n      for (let resource of resources) {\n        resourceCells.push(\n          <ResourceCell\n            key={resource.id + ':' + date.toISOString()}\n            resource={resource}\n            colSpan={1}\n            date={date}\n          />,\n        )\n      }\n    }\n\n    return (\n      <Fragment>\n        {this.buildTr(dateCells, 'day')}\n        {this.buildTr(resourceCells, 'resources')}\n      </Fragment>\n    )\n  }\n\n  renderResourceAndDayRows(resources: Resource[], dates: DateMarker[], dateFormat: DateFormatter, todayRange: DateRange) {\n    let resourceCells: VNode[] = []\n    let dateCells: VNode[] = []\n\n    for (let resource of resources) {\n      resourceCells.push(\n        <ResourceCell\n          key={resource.id}\n          resource={resource}\n          colSpan={dates.length}\n          isSticky\n        />,\n      )\n\n      for (let date of dates) {\n        dateCells.push(\n          this.renderDateCell(date, dateFormat, todayRange, 1, resource),\n        )\n      }\n    }\n\n    return (\n      <Fragment>\n        {this.buildTr(resourceCells, 'resources')}\n        {this.buildTr(dateCells, 'day')}\n      </Fragment>\n    )\n  }\n\n  // a cell with date text. might have a resource associated with it\n  renderDateCell(\n    date: DateMarker,\n    dateFormat: DateFormatter,\n    todayRange: DateRange,\n    colSpan: number,\n    resource?: Resource,\n    isSticky?: boolean,\n  ) {\n    let { props } = this\n    let keyPostfix = resource ? `:${resource.id}` : ''\n    let extraRenderProps = resource ? { resource: new ResourceApi(this.context, resource) } : {}\n    let extraDataAttrs = resource ? { 'data-resource-id': resource.id } : {}\n\n    return props.datesRepDistinctDays ? (\n      <TableDateCell\n        key={date.toISOString() + keyPostfix}\n        date={date}\n        dateProfile={props.dateProfile}\n        todayRange={todayRange}\n        colCnt={props.dates.length * props.resources.length}\n        dayHeaderFormat={dateFormat}\n        colSpan={colSpan}\n        isSticky={isSticky}\n        extraRenderProps={extraRenderProps}\n        extraDataAttrs={extraDataAttrs}\n      />\n    ) : (\n      <TableDowCell // we can't leverage the pure-componentness becausae the extra* props are new every time :(\n        key={date.getUTCDay() + keyPostfix}\n        dow={date.getUTCDay()}\n        dayHeaderFormat={dateFormat}\n        colSpan={colSpan}\n        isSticky={isSticky}\n        extraRenderProps={extraRenderProps}\n        extraDataAttrs={extraDataAttrs}\n      />\n    )\n  }\n\n  buildTr(cells: VNode[], key: string) {\n    let { renderIntro } = this.props\n\n    if (!cells.length) {\n      cells = [<td key={0}>&nbsp;</td>]\n    }\n\n    return (\n      <tr key={key} role=\"row\">\n        {renderIntro && renderIntro(key)}\n        {cells}\n      </tr>\n    )\n  }\n}\n\nfunction buildDateFormat(dayHeaderFormat: DateFormatter, datesRepDistinctDays, dayCnt) {\n  return dayHeaderFormat || computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt)\n}\n","import { Resource } from '../structs/resource.js'\n\nexport class ResourceIndex {\n  indicesById: { [resourceId: string]: number }\n  ids: string[]\n  length: number\n\n  constructor(resources: Resource[]) {\n    let indicesById = {}\n    let ids = []\n\n    for (let i = 0; i < resources.length; i += 1) {\n      let id = resources[i].id\n\n      ids.push(id)\n      indicesById[id] = i\n    }\n\n    this.ids = ids\n    this.indicesById = indicesById\n    this.length = resources.length\n  }\n}\n","import { CalendarContext, DayTableModel, DayTableCell } from '@fullcalendar/core/internal'\nimport { Resource } from '../structs/resource.js'\nimport { ResourceApi } from '../api/ResourceApi.js'\nimport { ResourceIndex } from './ResourceIndex.js'\n\nexport abstract class AbstractResourceDayTableModel {\n  cells: DayTableCell[][]\n  rowCnt: number\n  colCnt: number\n  resourceIndex: ResourceIndex\n\n  constructor(\n    public dayTableModel: DayTableModel,\n    public resources: Resource[],\n    private context: CalendarContext,\n  ) {\n    this.resourceIndex = new ResourceIndex(resources)\n    this.rowCnt = dayTableModel.rowCnt\n    this.colCnt = dayTableModel.colCnt * resources.length\n    this.cells = this.buildCells()\n  }\n\n  abstract computeCol(dateI, resourceI): number\n  abstract computeColRanges(dateStartI, dateEndI, resourceI): {\n    firstCol: number,\n    lastCol: number,\n    isStart: boolean,\n    isEnd: boolean\n  }[]\n\n  buildCells(): DayTableCell[][] {\n    let { rowCnt, dayTableModel, resources } = this\n    let rows: DayTableCell[][] = []\n\n    for (let row = 0; row < rowCnt; row += 1) {\n      let rowCells: DayTableCell[] = []\n\n      for (let dateCol = 0; dateCol < dayTableModel.colCnt; dateCol += 1) {\n        for (let resourceCol = 0; resourceCol < resources.length; resourceCol += 1) {\n          let resource = resources[resourceCol]\n          let extraRenderProps = { resource: new ResourceApi(this.context, resource) }\n          let extraDataAttrs = { 'data-resource-id': resource.id }\n          let extraClassNames = ['fc-resource']\n          let extraDateSpan = { resourceId: resource.id }\n          let date = dayTableModel.cells[row][dateCol].date\n\n          rowCells[\n            this.computeCol(dateCol, resourceCol)\n          ] = {\n            key: resource.id + ':' + date.toISOString(),\n            date,\n            extraRenderProps,\n            extraDataAttrs,\n            extraClassNames,\n            extraDateSpan,\n          }\n        }\n      }\n\n      rows.push(rowCells)\n    }\n\n    return rows\n  }\n}\n","import { AbstractResourceDayTableModel } from './AbstractResourceDayTableModel.js'\n\n/*\nresources over dates\n*/\nexport class ResourceDayTableModel extends AbstractResourceDayTableModel {\n  computeCol(dateI, resourceI) {\n    return resourceI * this.dayTableModel.colCnt + dateI\n  }\n\n  /*\n  all date ranges are intact\n  */\n  computeColRanges(dateStartI, dateEndI, resourceI) {\n    return [\n      {\n        firstCol: this.computeCol(dateStartI, resourceI),\n        lastCol: this.computeCol(dateEndI, resourceI),\n        isStart: true,\n        isEnd: true,\n      },\n    ]\n  }\n}\n","import { AbstractResourceDayTableModel } from './AbstractResourceDayTableModel.js'\n\n/*\ndates over resources\n*/\nexport class DayResourceTableModel extends AbstractResourceDayTableModel {\n  computeCol(dateI, resourceI) {\n    return dateI * this.resources.length + resourceI\n  }\n\n  /*\n  every single day is broken up\n  */\n  computeColRanges(dateStartI, dateEndI, resourceI) {\n    let segs = []\n\n    for (let i = dateStartI; i <= dateEndI; i += 1) {\n      let col = this.computeCol(i, resourceI)\n\n      segs.push({\n        firstCol: col,\n        lastCol: col,\n        isStart: i === dateStartI,\n        isEnd: i === dateEndI,\n      })\n    }\n\n    return segs\n  }\n}\n","import { SlicedProps, Seg, memoize, EventSegUiInteractionState } from '@fullcalendar/core/internal'\nimport { AbstractResourceDayTableModel } from './AbstractResourceDayTableModel.js'\n\nconst NO_SEGS = [] // for memoizing\n\nexport abstract class VResourceJoiner<SegType extends Seg> {\n  private joinDateSelection = memoize(this.joinSegs)\n  private joinBusinessHours = memoize(this.joinSegs)\n  private joinFgEvents = memoize(this.joinSegs)\n  private joinBgEvents = memoize(this.joinSegs)\n  private joinEventDrags = memoize(this.joinInteractions)\n  private joinEventResizes = memoize(this.joinInteractions)\n\n  /*\n  propSets also has a '' key for things with no resource\n  */\n  joinProps(\n    propSets: { [resourceId: string]: SlicedProps<SegType> },\n    resourceDayTable: AbstractResourceDayTableModel,\n  ): SlicedProps<SegType> {\n    let dateSelectionSets = []\n    let businessHoursSets = []\n    let fgEventSets = []\n    let bgEventSets = []\n    let eventDrags = []\n    let eventResizes = []\n    let eventSelection = ''\n    let keys = resourceDayTable.resourceIndex.ids.concat(['']) // add in the all-resource key\n\n    for (let key of keys) {\n      let props = propSets[key]\n\n      dateSelectionSets.push(props.dateSelectionSegs)\n      businessHoursSets.push(key ? props.businessHourSegs : NO_SEGS) // don't include redundant all-resource businesshours\n      fgEventSets.push(key ? props.fgEventSegs : NO_SEGS) // don't include fg all-resource segs\n      bgEventSets.push(props.bgEventSegs)\n      eventDrags.push(props.eventDrag)\n      eventResizes.push(props.eventResize)\n      eventSelection = eventSelection || props.eventSelection\n    }\n\n    return {\n      dateSelectionSegs: this.joinDateSelection(resourceDayTable, ...dateSelectionSets),\n      businessHourSegs: this.joinBusinessHours(resourceDayTable, ...businessHoursSets),\n      fgEventSegs: this.joinFgEvents(resourceDayTable, ...fgEventSets),\n      bgEventSegs: this.joinBgEvents(resourceDayTable, ...bgEventSets),\n      eventDrag: this.joinEventDrags(resourceDayTable, ...eventDrags),\n      eventResize: this.joinEventResizes(resourceDayTable, ...eventResizes),\n      eventSelection,\n    }\n  }\n\n  joinSegs(resourceDayTable: AbstractResourceDayTableModel, ...segGroups: SegType[][]): SegType[] {\n    let resourceCnt = resourceDayTable.resources.length\n    let transformedSegs = []\n\n    for (let i = 0; i < resourceCnt; i += 1) {\n      for (let seg of segGroups[i]) {\n        transformedSegs.push(\n          ...this.transformSeg(seg, resourceDayTable, i),\n        )\n      }\n\n      for (let seg of segGroups[resourceCnt]) { // one beyond. the all-resource\n        transformedSegs.push(\n          ...this.transformSeg(seg, resourceDayTable, i),\n        )\n      }\n    }\n\n    return transformedSegs\n  }\n\n  /*\n  for expanding non-resource segs to all resources.\n  only for public use.\n  no memoizing.\n  */\n  expandSegs(resourceDayTable: AbstractResourceDayTableModel, segs: SegType[]) {\n    let resourceCnt = resourceDayTable.resources.length\n    let transformedSegs = []\n\n    for (let i = 0; i < resourceCnt; i += 1) {\n      for (let seg of segs) {\n        transformedSegs.push(\n          ...this.transformSeg(seg, resourceDayTable, i),\n        )\n      }\n    }\n\n    return transformedSegs\n  }\n\n  joinInteractions(\n    resourceDayTable: AbstractResourceDayTableModel,\n    ...interactions: EventSegUiInteractionState[]\n  ): EventSegUiInteractionState | null {\n    let resourceCnt = resourceDayTable.resources.length\n    let affectedInstances = {}\n    let transformedSegs = []\n    let anyInteractions = false\n    let isEvent = false\n\n    for (let i = 0; i < resourceCnt; i += 1) {\n      let interaction = interactions[i]\n\n      if (interaction) {\n        anyInteractions = true\n\n        for (let seg of interaction.segs) {\n          transformedSegs.push(\n            ...this.transformSeg(seg as SegType, resourceDayTable, i), // TODO: templateify Interaction::segs\n          )\n        }\n\n        Object.assign(affectedInstances, interaction.affectedInstances)\n        isEvent = isEvent || interaction.isEvent\n      }\n\n      if (interactions[resourceCnt]) { // one beyond. the all-resource\n        for (let seg of interactions[resourceCnt].segs) {\n          transformedSegs.push(\n            ...this.transformSeg(seg as SegType, resourceDayTable, i), // TODO: templateify Interaction::segs\n          )\n        }\n      }\n    }\n\n    if (anyInteractions) {\n      return {\n        affectedInstances,\n        segs: transformedSegs,\n        isEvent,\n      }\n    }\n\n    return null\n  }\n\n  // needs to generate NEW seg obj!!! because of .el\n  abstract transformSeg(seg: SegType, resourceDayTable: AbstractResourceDayTableModel, resourceI: number): SegType[]\n}\n","import { EventDef, mapHash, Splitter, SplittableProps, DateSpan } from '@fullcalendar/core/internal'\nimport { AbstractResourceDayTableModel } from './AbstractResourceDayTableModel.js'\n\n// splitter\n\nexport interface VResourceProps extends SplittableProps {\n  resourceDayTableModel: AbstractResourceDayTableModel\n}\n\n/*\nTODO: just use ResourceHash somehow? could then use the generic ResourceSplitter\n*/\nexport class VResourceSplitter extends Splitter<VResourceProps> {\n  getKeyInfo(props: VResourceProps) {\n    let { resourceDayTableModel } = props\n\n    let hash = mapHash(\n      resourceDayTableModel.resourceIndex.indicesById,\n      (i) => resourceDayTableModel.resources[i], // has `ui` AND `businessHours` keys!\n    ) as any // :(\n\n    hash[''] = {}\n\n    return hash\n  }\n\n  getKeysForDateSpan(dateSpan: DateSpan): string[] {\n    return [dateSpan.resourceId || '']\n  }\n\n  getKeysForEventDef(eventDef: EventDef): string[] {\n    let resourceIds = eventDef.resourceIds\n\n    if (!resourceIds.length) {\n      return ['']\n    }\n\n    return resourceIds\n  }\n}\n","import { flexibleCompare, compareByFieldSpecs, OrderSpec } from '@fullcalendar/core/internal'\nimport { ResourceHash, Resource } from '../structs/resource.js'\nimport { ResourceEntityExpansions } from '../reducers/resourceEntityExpansions.js'\nimport { GroupSpec } from './resource-spec.js'\nimport { ResourceApi } from '../api/ResourceApi.js'\n\ninterface ParentNode {\n  children: ParentNode[]\n}\n\ninterface ResourceParentNode extends ParentNode {\n  resource: Resource\n  resourceFields: any\n}\n\ntype ResourceNodeHash = { [resourceId: string]: ResourceParentNode }\n\ninterface GroupParentNode extends ParentNode {\n  group: Group\n}\n\nexport interface Group {\n  value: any\n  spec: GroupSpec\n}\n\nexport interface GroupNode {\n  id: string // 'field:value'\n  isExpanded: boolean\n  group: Group\n}\n\nexport interface ResourceNode {\n  id: string // 'resourceId' (won't collide with group ID's because has colon)\n  rowSpans: number[]\n  depth: number\n  isExpanded: boolean\n  hasChildren: boolean\n  resource: Resource\n  resourceFields: any\n}\n\n/*\ndoesn't accept grouping\n*/\nexport function flattenResources(resourceStore: ResourceHash, orderSpecs: OrderSpec<ResourceApi>[]): Resource[] {\n  return buildRowNodes(resourceStore, [], orderSpecs, false, {}, true)\n    .map((node) => (node as ResourceNode).resource)\n}\n\nexport function buildRowNodes(\n  resourceStore: ResourceHash,\n  groupSpecs: GroupSpec[],\n  orderSpecs: OrderSpec<ResourceApi>[],\n  isVGrouping: boolean,\n  expansions: ResourceEntityExpansions,\n  expansionDefault: boolean,\n): (GroupNode | ResourceNode)[] {\n  let complexNodes = buildHierarchy(resourceStore, isVGrouping ? -1 : 1, groupSpecs, orderSpecs)\n  let flatNodes = []\n\n  flattenNodes(complexNodes, flatNodes, isVGrouping, [], 0, expansions, expansionDefault)\n\n  return flatNodes\n}\n\nfunction flattenNodes(\n  complexNodes: ParentNode[],\n  res, isVGrouping, rowSpans, depth,\n  expansions: ResourceEntityExpansions,\n  expansionDefault: boolean,\n) {\n  for (let i = 0; i < complexNodes.length; i += 1) {\n    let complexNode = complexNodes[i]\n    let group = (complexNode as GroupParentNode).group\n\n    if (group) {\n      if (isVGrouping) {\n        let firstRowIndex = res.length\n        let rowSpanIndex = rowSpans.length\n\n        flattenNodes(complexNode.children, res, isVGrouping, rowSpans.concat(0), depth, expansions, expansionDefault)\n\n        if (firstRowIndex < res.length) {\n          let firstRow = res[firstRowIndex]\n          let firstRowSpans = firstRow.rowSpans = firstRow.rowSpans.slice()\n\n          firstRowSpans[rowSpanIndex] = res.length - firstRowIndex\n        }\n      } else {\n        let id = group.spec.field + ':' + group.value\n        let isExpanded = expansions[id] != null ? expansions[id] : expansionDefault\n\n        res.push({ id, group, isExpanded })\n\n        if (isExpanded) {\n          flattenNodes(complexNode.children, res, isVGrouping, rowSpans, depth + 1, expansions, expansionDefault)\n        }\n      }\n    } else if ((complexNode as ResourceParentNode).resource) {\n      let id = (complexNode as ResourceParentNode).resource.id\n      let isExpanded = expansions[id] != null ? expansions[id] : expansionDefault\n\n      res.push({\n        id,\n        rowSpans,\n        depth,\n        isExpanded,\n        hasChildren: Boolean(complexNode.children.length),\n        resource: (complexNode as ResourceParentNode).resource,\n        resourceFields: (complexNode as ResourceParentNode).resourceFields,\n      })\n\n      if (isExpanded) {\n        flattenNodes(complexNode.children, res, isVGrouping, rowSpans, depth + 1, expansions, expansionDefault)\n      }\n    }\n  }\n}\n\nfunction buildHierarchy(\n  resourceStore: ResourceHash,\n  maxDepth: number,\n  groupSpecs: GroupSpec[],\n  orderSpecs: OrderSpec<ResourceApi>[],\n): ParentNode[] {\n  let resourceNodes = buildResourceNodes(resourceStore, orderSpecs)\n  let builtNodes: ParentNode[] = []\n\n  for (let resourceId in resourceNodes) {\n    let resourceNode = resourceNodes[resourceId]\n\n    if (!resourceNode.resource.parentId) {\n      insertResourceNode(resourceNode, builtNodes, groupSpecs, 0, maxDepth, orderSpecs)\n    }\n  }\n\n  return builtNodes\n}\n\nfunction buildResourceNodes(resourceStore: ResourceHash, orderSpecs: OrderSpec<ResourceApi>[]): ResourceNodeHash {\n  let nodeHash: ResourceNodeHash = {}\n\n  for (let resourceId in resourceStore) {\n    let resource = resourceStore[resourceId]\n\n    nodeHash[resourceId] = {\n      resource,\n      resourceFields: buildResourceFields(resource),\n      children: [],\n    }\n  }\n\n  for (let resourceId in resourceStore) {\n    let resource = resourceStore[resourceId]\n\n    if (resource.parentId) {\n      let parentNode = nodeHash[resource.parentId]\n\n      if (parentNode) {\n        insertResourceNodeInSiblings(nodeHash[resourceId], parentNode.children, orderSpecs)\n      }\n    }\n  }\n\n  return nodeHash\n}\n\nfunction insertResourceNode(\n  resourceNode: ResourceParentNode,\n  nodes: ParentNode[],\n  groupSpecs: GroupSpec[],\n  depth: number,\n  maxDepth: number,\n  orderSpecs: OrderSpec<ResourceApi>[],\n) {\n  if (groupSpecs.length && (maxDepth === -1 || depth <= maxDepth)) {\n    let groupNode = ensureGroupNodes(resourceNode, nodes, groupSpecs[0])\n\n    insertResourceNode(resourceNode, groupNode.children, groupSpecs.slice(1), depth + 1, maxDepth, orderSpecs)\n  } else {\n    insertResourceNodeInSiblings(resourceNode, nodes, orderSpecs)\n  }\n}\n\nfunction ensureGroupNodes(resourceNode: ResourceParentNode, nodes: ParentNode[], groupSpec: GroupSpec): GroupParentNode {\n  let groupValue = resourceNode.resourceFields[groupSpec.field]\n  let groupNode\n  let newGroupIndex\n\n  // find an existing group that matches, or determine the position for a new group\n  if (groupSpec.order) {\n    for (newGroupIndex = 0; newGroupIndex < nodes.length; newGroupIndex += 1) {\n      let node = nodes[newGroupIndex]\n\n      if ((node as GroupParentNode).group) {\n        let cmp = flexibleCompare(groupValue, (node as GroupParentNode).group.value) * groupSpec.order\n\n        if (cmp === 0) {\n          groupNode = node\n          break\n        } else if (cmp < 0) {\n          break\n        }\n      }\n    }\n  } else { // the groups are unordered\n    for (newGroupIndex = 0; newGroupIndex < nodes.length; newGroupIndex += 1) {\n      let node = nodes[newGroupIndex]\n\n      if ((node as GroupParentNode).group && groupValue === (node as GroupParentNode).group.value) {\n        groupNode = node\n        break\n      }\n    }\n  }\n\n  if (!groupNode) {\n    groupNode = {\n      group: {\n        value: groupValue,\n        spec: groupSpec,\n      },\n      children: [],\n    }\n\n    nodes.splice(newGroupIndex, 0, groupNode)\n  }\n\n  return groupNode\n}\n\nfunction insertResourceNodeInSiblings(resourceNode, siblings, orderSpecs: OrderSpec<ResourceApi>[]) {\n  let i\n\n  for (i = 0; i < siblings.length; i += 1) {\n    let cmp = compareByFieldSpecs(siblings[i].resourceFields, resourceNode.resourceFields, orderSpecs) // TODO: pass in ResourceApi?\n\n    if (cmp > 0) { // went 1 past. insert at i\n      break\n    }\n  }\n\n  siblings.splice(i, 0, resourceNode)\n}\n\nexport function buildResourceFields(resource: Resource): any {\n  let obj = { ...resource.extendedProps, ...resource.ui, ...resource }\n\n  delete obj.ui\n  delete obj.extendedProps\n\n  return obj\n}\n\nexport function isGroupsEqual(group0: Group, group1: Group) {\n  return group0.spec === group1.spec && group0.value === group1.value\n}\n"],"names":["refineRenderProps"],"mappings":"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"}